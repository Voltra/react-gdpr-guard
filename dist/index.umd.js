!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("gdpr-guard"),require("react")):"function"==typeof define&&define.amd?define(["exports","gdpr-guard","react"],r):r((e||self).reactGdprGuard={},e.gdprGuard,e.react)}(this,function(e,r,t){function n(){return n=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},n.apply(this,arguments)}function a(e,r){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},a(e,r)}var o=function(e){var r={store:null},n=new Set,a=function(){return r.store},o=function(e){return r.store=e(a()),n.forEach(function(e){return e()}),r.store};r.store=e(a,o);var i=function(e){"function"!=typeof e&&(e=function(){return e}),o(e)};return[r,function(){var e=t.useState(a()),r=e[0],o=e[1];return t.useEffect(function(){var e=function(){o(a())};return n.add(e),e(),function(){n.delete(e)}},[]),[r,i]}]},i=/*#__PURE__*/function(){function e(e,r){this._manager=void 0,this._globalStoreHolder=void 0,this._manager=e,this._globalStoreHolder=r}var r,t,n=e.prototype;return n.triggerUpdate=function(){this._globalStoreHolder.store.update(this.generateRawManager())},n.closeBanner=function(){this.manager.closeBanner(),this.triggerUpdate()},n.resetAndShowBanner=function(){this.manager.resetAndShowBanner(),this.triggerUpdate()},n.json=function(){return this.materializedState},n.toString=function(){return JSON.stringify(this.materializedState)},n.disable=function(e){return this.wrap("disable",e)},n.enable=function(e){return this.wrap("enable",e)},n.toggle=function(e){return this.wrap("toggle",e)},n.disableForStorage=function(e){return this.manager.disableForStorage(e),this},n.enableForStorage=function(e){return this.manager.enableForStorage(e),this},n.toggleForStorage=function(e){return this.manager.toggleForStorage(e),this},n.isEnabled=function(e){return this.manager.isEnabled(e)},n.hasGroup=function(e){return this.manager.hasGroup(e)},n.hasGuard=function(e){return this.manager.hasGuard(e)},n.getGroup=function(e){return this.manager.getGroup(e)},n.getGuard=function(e){return this.manager.getGuard(e)},n.generateRawManager=function(){return this.manager.raw()},n.hotswap=function(e){return this._manager=e,this.triggerUpdate(),this},n.wrap=function(e,r){var t,n=[].slice.call(arguments,2);if(void 0===r&&"function"==typeof this.manager[e])(t=this.manager)[e].apply(t,n),this.triggerUpdate();else if(this.manager.hasGuard(r)){var a=this.manager.getGuard(r);"function"==typeof(null==a?void 0:a[e])&&(null==a||a[e].apply(a,n),this.triggerUpdate())}return this},r=e,(t=[{key:"manager",get:function(){return this._manager}},{key:"materializedState",get:function(){return this._globalStoreHolder.store.materializedState}},{key:"bannerWasShown",get:function(){return this.manager.bannerWasShown}},{key:"events",get:function(){return this.manager.events}}])&&function(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,"symbol"==typeof(a=function(e,r){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key))?a:String(a),n)}var a}(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),e}(),u=/*#__PURE__*/function(e){var r,t;function n(r,t){var n;return(n=e.call(this)||this).savior=void 0,n.managerWrapper=void 0,n.savior=r,n.managerWrapper=t,n}t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,a(r,t);var o=n.prototype;return o.updateSharedManager=function(e){try{var r=this;return r.managerWrapper.manager===e?Promise.resolve():Promise.resolve(r.savior.updateSharedManager(e)).then(function(){r.managerWrapper.hotswap(e)})}catch(e){return Promise.reject(e)}},o.check=function(){return this.savior.check()},o.exists=function(e){return void 0===e&&(e=!0),this.savior.exists(e)},o.restore=function(e){return void 0===e&&(e=!0),this.savior.restore(e)},o.restoreOrCreate=function(e){return this.savior.restoreOrCreate(e)},o.store=function(e){return this.savior.store(e)},n}(r.GdprSaviorAdapter);e.createGdprGuardHooks=function(e,a){var s=r.GdprManager.create([]),c=o(function(e,r){return{materializedState:s.raw(),update:function(e){return r(function(r){return n({},r,{materializedState:e})})}}}),l=c[0],f=c[1],g=o(function(){return s})[1],d=new i(s,l),h=new u(e,d),p=function(){return d},b=function(e,r){void 0===r&&(r=[]);var n=f();return t.useMemo(e,[].concat(r,[e,n]))};return{useSetupGdprEffect:function(e){var r=p(),n=g(),o=n[0],i=n[1],u=t.useRef();!function(e,r){void 0===r&&(r=[]);var n=t.useRef(!1);t.useEffect(function(){n.current?e():n.current=!0},[].concat(r,[e]))}(t.useCallback(function(){return function(){try{var t=function(e,t){try{var n=Promise.resolve(h.restoreOrCreate(a)).then(function(e){r.hotswap(e),i(e)})}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(0,function(r){null==e||e(r)});return t&&t.then?t.then(function(){}):void 0}catch(e){Promise.reject(e)}}(),function(){}},[e,r])),t.useEffect(function(){u.current!==o&&r.bannerWasShown&&(u.current=r.manager,r.closeBanner())},[o,r])},useAttachGdprListenersEffect:function(e){var r=p(),n=g()[0];t.useEffect(function(){return e(r.events,n||r.manager)},[e,r.events,r.manager,n])},useGdprSavior:function(){return h},useGdprManager:p,useGdprComputed:b,useGdprGuardEnabledState:function(e,r){return void 0===r&&(r=!1),b(function(){var t,n;return(!r||d.bannerWasShown)&&null!=(t=null==(n=d.getGuard(e))?void 0:n.enabled)&&t},[e,d.bannerWasShown])},useGdprGuard:function(e){var r=p(),n=b(function(){var t;return null==(t=r.getGuard(e))?void 0:t.raw()},[e,r]),a=t.useCallback(function(){r.enable(e)},[e,r]),o=t.useCallback(function(){r.disable(e)},[e,r]),i=t.useCallback(function(){r.toggle(e)},[e,r]);return t.useDebugValue(e),{guard:n,enableGuard:a,disableGuard:o,toggleGuard:i}},useGdpr:function(){var e=p(),r=b(function(){return e.materializedState},[e,e.materializedState]),n=t.useCallback(function(){e.enable()},[e]),a=t.useCallback(function(){e.disable()},[e]),o=t.useCallback(function(){e.toggle()},[e]),i=t.useCallback(function(r){e.enable(r)},[e]),u=t.useCallback(function(r){e.disable(r)},[e]),s=t.useCallback(function(r){e.toggle(r)},[e]),c=t.useCallback(function(r,t){return void 0===t&&(t=!1),(!t||e.bannerWasShown)&&e.isEnabled(r)},[e]),l=t.useCallback(function(r){e.enableForStorage(r)},[e]),f=t.useCallback(function(r){e.disableForStorage(r)},[e]),g=t.useCallback(function(r){e.toggleForStorage(r)},[e]);return{closeGdprBanner:t.useCallback(function(){return e.closeBanner()},[e]),resetAndShowBanner:t.useCallback(function(){return e.resetAndShowBanner()},[e]),bannerWasShown:b(function(){return e.bannerWasShown},[e]),manager:r,enableManager:n,disableManager:a,toggleManager:o,enableGuard:i,disableGuard:u,toggleGuard:s,guardIsEnabled:c,enableForStorage:l,disableForStorage:f,toggleForStorage:g}}}}});
//# sourceMappingURL=index.umd.js.map
