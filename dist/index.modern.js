import{GdprSaviorAdapter as e,GdprManager as r}from"gdpr-guard";import{useCallback as n,useEffect as t,useMemo as a,useRef as o}from"react";function i(e,r){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e})(e,r)}var u=function(){function e(e){this._manager=e,this.state=this.generateRawManager()}var r,n,t=e.prototype;return t.triggerUpdate=function(){this.state=this.generateRawManager()},t.closeBanner=function(){this.manager.closeBanner(),this.triggerUpdate()},t.resetAndShowBanner=function(){this.manager.resetAndShowBanner(),this.triggerUpdate()},t.json=function(){return this.materializedState},t.toString=function(){return JSON.stringify(this.materializedState)},t.disable=function(e){return this.wrap("disable",e)},t.enable=function(e){return this.wrap("enable",e)},t.toggle=function(e){return this.wrap("toggle",e)},t.disableForStorage=function(e){return this.manager.disableForStorage(e),this},t.enableForStorage=function(e){return this.manager.enableForStorage(e),this},t.toggleForStorage=function(e){return this.manager.toggleForStorage(e),this},t.isEnabled=function(e){return this.manager.isEnabled(e)},t.hasGroup=function(e){return this.manager.hasGroup(e)},t.hasGuard=function(e){return this.manager.hasGuard(e)},t.getGroup=function(e){return this.manager.getGroup(e)},t.getGuard=function(e){return this.manager.getGuard(e)},t.generateRawManager=function(){return this.manager.raw()},t.hotswap=function(e){return this._manager=e,this.triggerUpdate(),this},t.wrap=function(e,r){for(var n=arguments.length,t=new Array(n>2?n-2:0),a=2;a<n;a++)t[a-2]=arguments[a];var o;if(void 0===r&&"function"==typeof this.manager[e])(o=this.manager)[e].apply(o,t),this.triggerUpdate();else if(this.manager.hasGuard(r)){var i=this.manager.getGuard(r);"function"==typeof(null==i?void 0:i[e])&&(null==i||i[e].apply(i,t),this.triggerUpdate())}return this},r=e,(n=[{key:"manager",get:function(){return this._manager}},{key:"materializedState",get:function(){return this.state}},{key:"bannerWasShown",get:function(){return this.manager.bannerWasShown}},{key:"events",get:function(){return this.manager.events}}])&&function(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}(),s=function(e){var r,n;function t(r,n){var t;return(t=e.call(this)||this).savior=r,t.managerWrapper=n,t}n=e,(r=t).prototype=Object.create(n.prototype),r.prototype.constructor=r,i(r,n);var a=t.prototype;return a.updateSharedManager=function(e){try{var r=this;return r.managerWrapper.manager===e?Promise.resolve():Promise.resolve(r.savior.updateSharedManager(e)).then(function(){r.managerWrapper.hotswap(e)})}catch(e){return Promise.reject(e)}},a.check=function(){return this.savior.check()},a.exists=function(e){return void 0===e&&(e=!0),this.savior.exists(e)},a.restore=function(e){return void 0===e&&(e=!0),this.savior.restore(e)},a.restoreOrCreate=function(e){return this.savior.restoreOrCreate(e)},a.store=function(e){return this.savior.store(e)},t}(e),g=function(e,r){return void 0===r&&(r=[]),n(e,r)},c=function(e,n){var i=r.create([]),c=new u(i),f=new s(e,c),d=function(e,r){void 0===r&&(r=[]);var n=g(e,r);return a(n,[c.materializedState,n])},h=function(){return c};return{useSetupGdprEffect:function(){!function(e,r){void 0===r&&(r=[]);var n=o(!1);t(function(){n.current&&e(),n.current=!0},[].concat(r,[e,n]))}(g(function(){try{return Promise.resolve(f.restoreOrCreate(n)).then(function(){})}catch(e){Promise.reject(e)}})),t(function(){c.bannerWasShown&&c.closeBanner()},[c.manager])},useAttachGdprListenersEffect:function(e){var r=h();t(function(){e(r.manager.events)},[e,r.manager])},useGdprSavior:function(){return f},useGdprManager:h,useGdprComputed:d,useGdprGuardEnabledState:function(e,r){return void 0===r&&(r=!1),d(function(){var n,t;return(!r||c.bannerWasShown)&&null!=(n=null===(t=c.getGuard(e))||void 0===t?void 0:t.enabled)&&n},[e,c.bannerWasShown])},useGdprGuard:function(e){return{guard:d(function(){var r;return null===(r=c.getGuard(e))||void 0===r?void 0:r.raw()},[e]),enableGuard:g(function(){c.enable(e)},[e]),disableGuard:g(function(){c.disable(e)},[e]),toggleGuard:g(function(){c.toggle(e)},[e])}},useGdpr:function(){var e=d(function(){return c.materializedState}),r=g(function(){c.enable()}),n=g(function(){c.disable()}),t=g(function(){c.toggle()}),a=g(function(e){c.enable(e)}),o=g(function(e){c.disable(e)}),i=g(function(e){c.toggle(e)}),u=g(function(e,r){return void 0===r&&(r=!1),(!r||c.bannerWasShown)&&c.isEnabled(e)}),s=g(function(e){c.enableForStorage(e)}),f=g(function(e){c.disableForStorage(e)}),h=g(function(e){c.toggleForStorage(e)});return{closeGdprBanner:g(function(){return c.closeBanner()}),resetAndShowBanner:g(function(){return c.resetAndShowBanner()}),bannerWasShown:d(function(){return c.bannerWasShown}),manager:e,enableManager:r,disableManager:n,toggleManager:t,enableGuard:a,disableGuard:o,toggleGuard:i,guardIsEnabled:u,enableForStorage:s,disableForStorage:f,toggleForStorage:h}}}};export{c as createGdprGuardHooks};
//# sourceMappingURL=index.modern.js.map
